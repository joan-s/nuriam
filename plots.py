#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Aug 22 10:36:05 2022

@author: joan
"""
import numpy as np
import matplotlib.pyplot as plt

experiment_id = '968615'
accuracy= [
    0.887042236328125,
    0.9051441539417614,
    0.9093611283735795,
    0.8978077281605114,
    0.905181884765625,
    0.9123696067116477,
    0.9136807528409091,
    0.9222056995738637,
    0.9190207741477273,
    0.920819091796875,
    0.9391091086647727,
    0.9287270285866477,
    0.9294206099076705,
    0.9308332963423296,
    0.9326882102272728,
    0.9311146129261364,
    0.9348516290838068,
    0.9362460049715909,
    0.9330999200994318,
    0.9128761985085228,
    0.9419544566761363,
    0.9393970836292613,
    0.9400762384588068,
    0.9419178355823864,
    0.8054515491832387,
    0.9430891557173295,
    0.9432994495738637,
    0.9439503062855114,
    0.9438160289417613,
    0.9432567249644886,
    0.9449701482599432,
    0.94278564453125,
    0.9433377352627841,
    0.9447393243963068,
    0.942730712890625,
    0.9466774680397727,
    0.9445040616122159,
    0.9439464222301136,
    0.9427373712713069,
    0.9437111594460227,
    0.9449057839133522,
    0.947845458984375,
    0.947222900390625,
    0.9467923251065341,
    0.9464222301136364,
    0.9458218661221591,
    0.9455316716974432,
    0.9451310591264205,
    0.9452009721235796,
    0.9330988103693182,
]

precision= np.array([
    [0.3526345 , 0.97941973, 0.61826861],
    [0.36148   , 0.97827587, 0.96347319],
    [0.37534479, 0.97492801, 0.90918204],
    [0.33819072, 0.97454084, 0.90938507],
    [0.34365731, 0.96887859, 0.94744483],
    [0.38419583, 0.97463967, 0.91727826],
    [0.39087669, 0.97480308, 0.90866806],
    [0.41666667, 0.97184239, 0.94194787],
    [0.4082522 , 0.97221633, 0.91603008],
    [0.41374965, 0.97187972, 0.92337607],
    [0.50475219, 0.98059573, 0.94520979],
    [0.44395343, 0.96949825, 0.95824102],
    [0.45032357, 0.97258243, 0.94784625],
    [0.45737662, 0.96879972, 0.950513  ],
    [0.47854976, 0.9694907 , 0.92263808],
    [0.46448583, 0.96856154, 0.93467576],
    [0.48880704, 0.96875722, 0.93809143],
    [0.497345  , 0.96818281, 0.94085285],
    [0.47470005, 0.97180921, 0.92451723],
    [0.44840177, 0.97894248, 0.70604038],
    [0.53339266, 0.96956056, 0.96129523],
    [0.51918849, 0.96732289, 0.95365638],
    [0.52144067, 0.96789758, 0.95844552],
    [0.53688785, 0.96903601, 0.95519805],
    [0.20936627, 0.98384287, 0.95019923],
    [0.53684137, 0.97030079, 0.97440712],
    [0.54772768, 0.96605941, 0.97298874],
    [0.55331511, 0.96606572, 0.97656786],
    [0.55410409, 0.96533921, 0.97642367],
    [0.54971016, 0.96479973, 0.9769861 ],
    [0.5633379 , 0.96654392, 0.97232804],
    [0.54572887, 0.96470295, 0.97679898],
    [0.55015298, 0.96509253, 0.97583321],
    [0.56207363, 0.96622441, 0.97110129],
    [0.54616409, 0.96425309, 0.97654978],
    [0.57452601, 0.96868007, 0.97040707],
    [0.55951425, 0.96599081, 0.97473092],
    [0.55375192, 0.96606942, 0.97666058],
    [0.54532657, 0.96460199, 0.97738781],
    [0.55330221, 0.96540014, 0.975711  ],
    [0.56113272, 0.96694385, 0.97445153],
    [0.58648711, 0.96923246, 0.96262712],
    [0.58256176, 0.96816611, 0.96714047],
    [0.58159775, 0.96715312, 0.96652062],
    [0.57695185, 0.96716752, 0.96897972],
    [0.57181105, 0.96676535, 0.9702068 ],
    [0.56991736, 0.96634345, 0.97009405],
    [0.56451218, 0.96676127, 0.9711979 ],
    [0.56477049, 0.96679657, 0.97197332],
    [0.46692922, 0.95956531, 0.96323433],
])

recall = np.array([
    [0.72662055, 0.93893632, 0.35825936],
    [0.70239925, 0.95489585, 0.44235994],
    [0.65247429, 0.95977736, 0.48680897],
    [0.64940888, 0.9420543 , 0.54767351],
    [0.57040372, 0.95916916, 0.50656868],
    [0.63939827, 0.95242297, 0.63883407],
    [0.63816295, 0.95103225, 0.67751125],
    [0.59766297, 0.96710884, 0.63226126],
    [0.60352842, 0.96240356, 0.64064242],
    [0.59487208, 0.96200976, 0.68032699],
    [0.69297427, 0.97121992, 0.7444449 ],
    [0.56075912, 0.97523684, 0.65711573],
    [0.59599758, 0.9693476 , 0.7120763 ],
    [0.54682296, 0.97620385, 0.6884852 ],
    [0.55292632, 0.97662565, 0.70510714],
    [0.54387651, 0.97738971, 0.6799389 ],
    [0.54406867, 0.98100774, 0.68841914],
    [0.53222796, 0.98185261, 0.70888898],
    [0.56803375, 0.9712231 , 0.76772222],
    [0.60343692, 0.9371728 , 0.87675984],
    [0.54847919, 0.98724561, 0.70917799],
    [0.52079902, 0.98746382, 0.69326617],
    [0.52686578, 0.98688298, 0.70543743],
    [0.54151568, 0.98789516, 0.70648611],
    [0.78871564, 0.82088251, 0.62027167],
    [0.55975257, 0.98957408, 0.68566946],
    [0.49870063, 0.99275886, 0.70255563],
    [0.50018301, 0.99320355, 0.70513191],
    [0.49021815, 0.99371378, 0.70550349],
    [0.48332784, 0.99389255, 0.70107758],
    [0.50369679, 0.99308459, 0.71868214],
    [0.48321804, 0.99383275, 0.69494241],
    [0.48702463, 0.99366861, 0.70185376],
    [0.49834376, 0.9930655 , 0.72032534],
    [0.47639179, 0.99397907, 0.6983857 ],
    [0.53100179, 0.99218819, 0.7310846 ],
    [0.49749277, 0.99350511, 0.71188638],
    [0.50131767, 0.99335179, 0.70212625],
    [0.48208338, 0.99385883, 0.69490938],
    [0.4913162 , 0.99359163, 0.70453738],
    [0.51096226, 0.99291663, 0.71334792],
    [0.53162403, 0.99145848, 0.75737583],
    [0.5204696 , 0.99238796, 0.74611288],
    [0.50569159, 0.9928651 , 0.74684778],
    [0.50809817, 0.99295926, 0.73794641],
    [0.50420922, 0.99304578, 0.73139837],
    [0.49791369, 0.99326654, 0.72989555],
    [0.50572819, 0.99293826, 0.72114281],
    [0.50629552, 0.99291854, 0.72192725],
[0.41659346, 0.98503039, 0.72515586]
])

per_class_iou = np.array([
    [0.31132945, 0.9207699 , 0.2933675 ],
    [0.31347014, 0.9350678 , 0.43506367],
    [0.31280845, 0.93665841, 0.46423453],
    [0.28597793, 0.91942677, 0.51933226],
    [0.2729988 , 0.93050086, 0.49272336],
    [0.3157752 , 0.92939058, 0.60403492],
    [0.31996421, 0.92821444, 0.63431567],
    [0.32539544, 0.94074863, 0.60854845],
    [0.32191717, 0.93664285, 0.60510697],
    [0.32279367, 0.93595766, 0.64397149],
    [0.41250293, 0.95290626, 0.71364906],
    [0.32940405, 0.94620509, 0.63882222],
    [0.34500787, 0.94356343, 0.68522845],
    [0.33166094, 0.94644871, 0.66466049],
    [0.34504103, 0.94750518, 0.6657467 ],
    [0.33427254, 0.94733548, 0.64909349],
    [0.34676465, 0.95092259, 0.65850229],
    [0.34607215, 0.95116202, 0.6786454 ],
    [0.3487903 , 0.94460986, 0.72243893],
    [0.34634231, 0.91865363, 0.64229673],
    [0.37064291, 0.95756616, 0.68949046],
    [0.35134451, 0.95558782, 0.67067141],
    [0.35514134, 0.95560404, 0.68450192],
    [0.36910516, 0.95766493, 0.68382647],
    [0.19824739, 0.80996346, 0.60074215],
    [0.37746514, 0.96048191, 0.67353957],
    [0.35324009, 0.9592998 , 0.68911531],
    [0.3563085 , 0.95972125, 0.69340013],
    [0.3515404 , 0.95947993, 0.69368667],
    [0.34624486, 0.95911346, 0.68968767],
    [0.36225913, 0.960082  , 0.70427732],
    [0.34460526, 0.95896214, 0.68365772],
    [0.34831549, 0.95919415, 0.68986284],
    [0.35896675, 0.95974892, 0.70520853],
    [0.34128946, 0.95865373, 0.68686655],
    [0.3811269 , 0.96134813, 0.71514075],
    [0.35748195, 0.95992884, 0.69898654],
    [0.35706558, 0.95986331, 0.69053981],
    [0.34386789, 0.95888665, 0.68391412],
    [0.35178075, 0.95942623, 0.69239384],
    [0.36506992, 0.96031949, 0.70025128],
    [0.38668326, 0.96120635, 0.7357419 ],
    [0.37908972, 0.96102926, 0.7276666 ],
    [0.3707973 , 0.96047768, 0.72801397],
    [0.37018247, 0.96058   , 0.72091541],
    [0.36601437, 0.96026419, 0.71533212],
    [0.36192275, 0.96005419, 0.71383348],
    [0.36379674, 0.96015963, 0.70604309],
    [0.36419765, 0.960176  , 0.7072056 ],
    [0.28232048, 0.94577346, 0.70562524],
])

mean_iou = [
    0.5084889487423051,
    0.5612005354765145,
    0.5712337994911777,
    0.574912322157164,
    0.5654076724505469,
    0.6164002340833884,
    0.6274981063896334,
    0.6248975051753064,
    0.621222328507297,
    0.6342409390753034,
    0.6930194168954503,
    0.6381437862828133,
    0.6579332473136161,
    0.6475900459635285,
    0.6527643027782198,
    0.6435671690052749,
    0.652063175875151,
    0.658626520382504,
    0.6719463617772417,
    0.6357642233615883,
    0.6725665096403591,
    0.6592012443608354,
    0.6650824342015856,
    0.6701988545793999,
    0.5363176666482635,
    0.6704955414811883,
    0.6672183984751152,
    0.6698099618298897,
    0.6682356688359236,
    0.6650153290826336,
    0.6755394849745974,
    0.6624083755178455,
    0.6657908253495759,
    0.6746414003364922,
    0.6622699118072565,
    0.6858719239323006,
    0.6721324451745337,
    0.6691562297554543,
    0.6622228884340432,
    0.6678669392747247,
    0.6752135633551338,
    0.6945438376062683,
    0.6892618595554288,
    0.6864296501364162,
    0.6838926258423879,
    0.680536894660904,
    0.6786034733877341,
    0.6766664848954108,
    0.6771930856776932,
    0.644573056916176,
]

plt.close('all')

plt.figure()
plt.plot(accuracy, 'b.-')
plt.ylabel('accuracy')
plt.xlabel('epoch')
plt.ylim([0.8, 1.0])
plt.title('experiment {}'.format(experiment_id))
plt.grid('on')

plt.figure()
plt.plot(precision[:,0], 'r.-', label='transition')
plt.plot(precision[:,1], 'g.-', label='fluid')
plt.plot(precision[:,2], 'y.-', label='gas')
plt.xlabel('epoch')
plt.ylabel('precision')
plt.ylim([0.3, 1.0])
plt.title('experiment {}'.format(experiment_id))
plt.grid('on')
plt.legend()

plt.figure()
plt.plot(recall[:,0], 'r.-', label='transition')
plt.plot(recall[:,1], 'g.-', label='fluid')
plt.plot(recall[:,2], 'y.-', label='gas')
plt.xlabel('epoch')
plt.ylabel('recall')
plt.ylim([0.3, 1.0])
plt.title('experiment {}'.format(experiment_id))
plt.grid('on')
plt.legend()

plt.figure()
plt.plot(per_class_iou[:,0], 'r.-', label='transition')
plt.plot(per_class_iou[:,1], 'g.-', label='fluid')
plt.plot(per_class_iou[:,2], 'y.-', label='gas')
plt.plot(mean_iou, 'k.-', label='mean')
plt.xlabel('epoch')
plt.ylabel('IoU')
plt.ylim([0.0, 1.0])
plt.title('experiment {}'.format(experiment_id))
plt.grid('on')
plt.legend()
